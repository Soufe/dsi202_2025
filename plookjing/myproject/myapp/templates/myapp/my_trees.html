{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 py-10 font-[Prompt]">
  <h1 class="text-3xl font-bold text-green-800 mb-6">üå≥ ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h1>

  {% if plantings %}
    <div class="grid gap-6">
      {% for tree in plantings %}
        <div class="bg-white shadow rounded-xl p-6 flex justify-between items-center">
          <div class="flex items-center space-x-4">
            {% if tree.tree.image %}
              <img src="{{ tree.tree.image.url }}" alt="{{ tree.tree.name }}" class="w-20 h-20 object-cover rounded-lg border">
            {% else %}
              <div class="w-20 h-20 bg-gray-200 rounded-lg flex items-center justify-center text-gray-500 text-sm">
                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ
              </div>
            {% endif %}

            <div>
              <div class="text-lg font-semibold text-green-700">{{ tree.tree.name }}</div>
              <div class="text-sm s="text-sm text-gray-600">üóìÔ∏è {{ tree.planted_date|date:"d M Y" }}</div>
              <div class="text-sm text-gray-600">ü™¥ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: {{ tree.quantity }} ‡∏ï‡πâ‡∏ô</div>

              <!-- ‚úÖ ‡πÅ‡∏ñ‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
              <div class="text-sm mt-2">
                <span class="inline-block px-3 py-1 rounded-full text-white text-xs font-medium
                  {% if tree.status == 'pending' %} bg-yellow-500
                  {% elif tree.status == 'planted' %} bg-green-600
                  {% elif tree.status == 'growing' %} bg-blue-600
                  {% elif tree.status == 'completed' %} bg-gray-600
                  {% endif %}">
                  {{ tree.status_display }}
                </span>
              </div>
            </div>
          </div>

          <!-- üëÅÔ∏è‚Äçüó®Ô∏è ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î -->
          <button onclick="openModal('modal-{{ forloop.counter }}')" class="text-orange-600 hover:underline">
            ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏îüìç {{ tree.location_name }} </div>
              <div class>
          </button>
        </div>

        <!-- üîç Modal -->
        <div id="modal-{{ forloop.counter }}" class="fixed inset-0 bg-black bg-opacity-50 hidden justify-center items-center z-50">
          <div class="bg-white rounded-xl p-6 max-w-lg w-full relative">
            <h2 class="text-xl font-bold text-green-700 mb-4">üå≥ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ</h2>
            <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> {{ tree.tree.name }}</p>
            <p class="text-sm text-gray-500">üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å: {{ planting.location_name }}</p>
            <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å:</strong> {{ tree.planted_date|date:"d M Y" }}</p>
            <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</strong> {{ tree.quantity }} ‡∏ï‡πâ‡∏ô</p>
            <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> {{ tree.status_display }}</p>

            {% if tree.tree.image %}
              <div class="mt-4">
                <p class="font-medium">‡∏£‡∏π‡∏õ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ:</p>
                <img src="{{ tree.tree.image.url }}" alt="{{ tree.tree.name }}" class="mt-2 max-h-60 rounded border shadow">
              </div>
            {% endif %}

            <div class="mt-6 text-right">
              <button onclick="closeModal('modal-{{ forloop.counter }}')" class="text-red-500 hover:underline">‡∏õ‡∏¥‡∏î</button>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-gray-600">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</p>
  {% endif %}
</div>

<!-- ‚úÖ Modal Script -->
<script>
  function openModal(id) {
    document.getElementById(id).classList.remove('hidden');
    document.getElementById(id).classList.add('flex');
  }
  function closeModal(id) {
    document.getElementById(id).classList.add('hidden');
    document.getElementById(id).classList.remove('flex');
  }
</script>
{% endblock %}
